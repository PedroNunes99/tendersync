---------------------------- section ----------------------------
troubleshooting
---------------------------- document_id ----------------------------
1256
---------------------------- title ----------------------------
My application seems slow and sometimes unresponsive, and no New Relic data is available.
---------------------------- permalink ----------------------------
application_stalls_from_dns_problems
---------------------------- keywords ----------------------------

---------------------------- body ----------------------------
On the morning of March 10, 2009, some customers applications were affected by RPM monitoring, experiencing sluggishness and frequent stalls in the Rails applications.  These customers were unable to see performance data on RPM and in some cases lost data.  Our agent is designed to operate smoothly in the event of server downtime or network failure, and have done extensive testing to ensure that this would never occur.  We recognize this is situation is unacceptable and as soon as we became aware of the situation took immediate steps to correct the problem, determine what happened and prevent any possibility of this happening again.  After careful investigation, our CEO, Lewis Cirne, issued this statement later in the day, which was sent to all our customers:

<hr/>

Dear Valued New Relic Customer,

This morning there was a network routing failure within one of the communications providers upstream of the data center used to host the New Relic RPM service. This caused a disruption to normal Internet traffic and affected our service and hundreds of other customers hosted there. During this period, lasting about two hours, some RPM customers’ applications could not communicate with the RPM service. Thus, for some customers, no application performance data was collected for that time period. If your application was affected, you may see gaps in the performance data on your RPM charts and reports. Some also experienced excessively slow response times on their applications.

We've determined that the root cause of this problem was DNS-related. There were a number of rarely occurring factors that when combined, resulted in DNS requests that would stall on the client. These factors are as follows:

1) Part of the Internet lost contact with our DNS servers due to a routing failure at one of our data center's network providers. Only customers coming through that route experienced problems. This was the main event that triggered problems, however this alone would not normally impact our agent. But…

2) We did not have redundancy for our DNS server at a remote site. As a result, any DNS lookups for RPM coming through the failed router would fail to resolve. This normally wouldn't impact things because DNS keeps a local cache. However…

3) While working through some DNS issues recently, our TTL was set very low - 5 minutes as opposed to the normal 24 hours. As a result, DNS lookups were occurring much more frequently than normal. This in combination with the other two factors was enough to affect DNS lookup in a way that caused the Ruby VM to stall.

We have addressed this problem as our top priority today in 2 ways: First, we have added redundancy to and improved the quality of our DNS services to reduce the likelihood that this will happen again. Second, we modified our time-to-live settings to 24-hours.

This was a rare set of circumstances that triggered this situation, so we do not expect to see anything similar happening again.

We take this seriously and will continue to work hard to give you great service. We apologize for the disruption.

Sincerely

Lewis Cirne Founder and CEO New Relic
